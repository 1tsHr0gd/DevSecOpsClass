{% extends 'taskManager/base_backend.html' %}

{% block content   %}

<!--main content start-->

    <section class="wrapper site-min-height">
        <!-- page start-->
        <section class="panel">
            <header class="panel-heading">
                Projects Details
                <span class="pull-right">
                  <a href="{% url 'taskManager:proj_details' proj.id %}" id="loading-btn" class="btn btn-warning btn-xs"><i class="fa fa-refresh"></i> Refresh</a>
                  <a href="{% url 'taskManager:edit_project' proj.id %}" id="loading-btn" class="btn btn-info btn-xs"><i class="fa fa-pencil"></i> Edit Project</a>
                </span>
            </header>

        </section>
        <div class="row">
            <div class="col-md-8">
                <section class="panel">
                    <div class="bio-graph-heading project-heading">
                        <strong> [{{proj.title}}]</strong>
                    </div>
                    <div class="panel-body bio-graph-info">
                        <!--<h1>New Dashboard BS3 </h1>-->
                        <div class="row p-details">
                            <div class="bio-row">
                                <p><span class="bold">Status </span>: <span class="label label-primary">Active</span></p>
                            </div>
                            <div class="bio-row">
                                <p><span class="bold">Created </span>: {{proj.start_date}} </p>
                            </div>
                            <div class="bio-row">
                                <p><span class="bold">Due </span>: {% if proj.is_overdue %}<b style="color:red">{{proj.due_date}}</b>{% else %}{{proj.due_date}}{% endif %} </p>
                            </div>
                            <div class="bio-row">
                                <p><span class="bold">Participants </span>:
                                <span class="p-team">
                                    {% for u in proj.users_assigned.all%}
                                      <a href="#"><img alt="image" class="" src="{% url 'taskManager:download_profile_pic' u.id %}"></a>
                                    {% endfor %}
                                </span>
                                </p>
                            </div>

                            
                        </div>

                    </div>

                </section>

                <section class="panel">
                  <header class="panel-heading">
                    Tasks
                  </header>
                  <div class="panel-body">
                      <table class="table table-hover p-table">
                    <thead>
                    <tr>
                        <th>Title</th>
                        <th>Created</th>
                        <th>Due Date</th>
                        <th>Description</th>
                        <th>Notes</th>
                        <th>Status</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for task in proj.task_set.all %}  
                      <tr>
                          <td>
                              <a href="{% url 'taskManager:task_details' project_id=proj.id task_id=task.id %}">{{task.title}}</a>
                          </td>
                          <td>
                              {{task.start_date}}
                          </td>
                          <td>
                          {% if task.is_overdue %}
                            <b style="color:red">{{task.due_date}}</b>
                          {% else %}
                            {{task.due_date}}
                          {% endif %}
                          </td>
                          <td>
                            {{task.text}}
                          </td>
                          <td>
                              {% if task.notes_set.count > 0 %}
                                <span class="badge bg-success">{{task.notes_set.count}}</span>
                              {% else %}
                              <span class="badge">0</span>
                              {% endif %}<a href="{% url 'taskManager:new_note' project_id=task.project.id task_id=task.id %}">(add)</a>
                          </td>
                          <td>
                             {% if task.completed == True %}
                              	 <a href="{% url 'taskManager:complete_task' project_id=proj.id task_id=task.id %}"><span class="label label-info"><i class="fa fa-check"></i> Completed</span></a>
                              {% else %}
                              	 <a href="{% url 'taskManager:complete_task' project_id=proj.id task_id=task.id %}"><span class="label label-warning"><i class="fa fa-tasks"></i> In Progress</span></a>
                              {% endif %}
                             
                          </td>
                          <td><a href="{% url 'taskManager:edit_task' project_id=proj.id task_id=task.id %}">Edit</a></td>
                          <td><a href="{% url 'taskManager:delete_task' project_id=proj.id task_id=task.id %}">Delete</a></td>
                      </tr>
                    {% endfor %}  
                </tbody>
                    </table>
                  </div>
                </section>

            </div>
            <div class="col-md-4">
                <section class="panel">
                    <header class="panel-heading">
                        Projects Description
                    </header>

                    <div class="panel-body">
                        <p>
                            {{proj.text}}
                        </p>
                        <br/>
                        <h5 class="bold">Priority</h5>
                        <ul class="nav nav-pills nav-stacked labels-info ">
                          {% if proj.priority == 1 %}
                            <li><i class=" fa fa-circle text-primary"></i> Low Priority</li>
                          {% elif proj.priority = 2 %}
                            <li><i class=" fa fa-circle text-success"></i> Medium Priority</li>
                          {% elif proj.priority = 3 %}
                            <li><i class=" fa fa-circle text-danger"></i> High Priority</li>
                          {% elif proj.priority = 4 %}
                            <li class="text-danger"><i class="fa fa-circle"></i> Urgent Priority</li>
                          {% elif proj.priority = 5 %}
                            <li class="text-danger"><strong><i class=" fa fa-circle"></i> SUPER URGENT Priority</strong></li>
                          {% else %}
                            <li><i class=" fa fa-circle text-muted"></i> No Priority</li>
                          {% endif %}
                        </ul>

                        <br/>
                        <h5 class="bold">Project files</h5>
                          <span class="p-team">
                              {% for u in proj.file_set.all %}
                                <a href="{% url 'taskManager:download_file' file_id=u.id %}"><i class="fa fa-paperclip"></i> {{u.name}}</a><br />
                              {% endfor %}
                          </span>

                        <h5 class="bold">Project Tags</h5>
                        
                        <div class="text-center mtop20">
                            <a href="{% url 'taskManager:new_task' proj.id %}" class="btn btn-sm btn-primary">Add task</a>
                            <a href="{% url 'taskManager:new_file' proj.id %}" class="btn btn-sm btn-primary">Add files</a>
                        </div>
                    </div>

                </section>
            </div>
        </div>
        <!-- page end-->
    </section>

{% endblock %}